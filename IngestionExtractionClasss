import zeep
client = zeep.Client(wsdl = 'https://doc.s3.amazonaws.com/2006-03-01/AmazonS3.wsdl')
print(client)
from zeep import Client

client = Client(wsdl = 'https://doc.s3.amazonaws.com/2006-03-01/AmazonS3.wsdl')

class AmazonS3:
           
    def create_bucket(bucketname, aws_Access_Key, time_stamp, signature):
        response = client.service.CreateBucket(Bucket = bucketname, AWSAccessKeyId = aws_Access_Key, Timestamp = time_stamp,
                                           Signature = signature)
    
    def ingesting_data(bucketname, filename, due, content, aws_Access_Key, time_stamp, signature, principal_document):
        response = client.service.PutObject(Bucket = bucketname, Key = filename, Metadata = due, ContentLength = content,
                                       AWSAccessKeyId = aws_Access_Key, Timestamp = time_stamp, Signature = signature, Credential = principal_document)
        
    def extracting_data(bucketname, filename, check, confirm, go, aws_Access_Key, time_stamp, signature, principal_document):
        response = client.service.GetObject(Bucket = bucketname, Key = filename, GetMetadata = check, GetData = confirm, InlineData = go,
                                            AWSAccessKeyId = aws_Access_Key, Timestamp = time_stamp, Signature = signature, Credential = principal_document)


my_S3 = AmazonS3
# myS3.create_bucket('ejike006','AKIAYDLYZSO5BEQ4ECDY','2022-06-24T22:25:05.183Z','61FfOeGFS+6mGF8bD3zENR2gYpyfZHF27HfCufHV')

# myS3.ingesting_data('ejike006', 'ejike_script.json', {'Name': 'ejike ezeh', 'Value': '006'}, 2,'AKIAYDLYZSO5BEQ4ECDY','2022-06-24T22:25:05.183Z',
#                        '61FfOeGFS+6mGF8bD3zENR2gYpyfZHF27HfCufHV', 'principal_script')

myS3.tracting_data('ejike006', 'ejike_script.json', True, True, True,'AKIAYDLYZSO5BEQ4ECDY','2022-06-24T22:40:05.183Z',
                         '61FfOeGFS+6mGF8bD3zENR2gYpyfZHF27HfCufHV', 'principal_script')